/*
 * Template7 0.9.9
 * Mobile-first JavaScript template engine
 *
 * http://www.idangero.us/framework7/docs/template7.html
 *
 * Copyright 2014, Vladimir Kharlampidi
 * The iDangero.us
 * http://www.idangero.us/
 *
 * Licensed under MIT
 *
 * Released on: August 30, 2014
*/
window.Template7=function(){"use strict";function a(a){return"[object Array]"===Object.prototype.toString.apply(a)}function b(a){return"function"==typeof a}function c(a){var b,c,d=[];if(!a)return[];var e=a.split(/({{[^{^}]*}})/);for(b=0;b<e.length;b++){var f=e[b];if(""!==f)if(f.indexOf("{{")<0)d.push({type:"plain",content:f});else{if(f.indexOf("{/")>=0)continue;if(f.indexOf("{#")<0&&f.indexOf(" ")<0&&f.indexOf("else")<0){d.push({type:"variable",contextName:f.replace(/[{}]/g,"")});continue}var g=f.replace(/[{}#}]/g,"").split(" "),h=g[0],i=g[1],j={};if(g.length>1)for(var k,l=new RegExp(/\b(\w+)=["']([^"']+)(?=["'])/g);null!==(k=l.exec(f));)j[k[1]]="false"===k[2]?!1:k[2];if(f.indexOf("{#")>=0){var m,n="",o="",p=0,q=!1,r=!1,s=0;for(c=b+1;c<e.length;c++)if(e[c].indexOf("{{#")>=0&&s++,e[c].indexOf("{{/")>=0&&s--,e[c].indexOf("{{#"+h)>=0)n+=e[c],r&&(o+=e[c]),p++;else if(e[c].indexOf("{{/"+h)>=0){if(!(p>0)){m=c,q=!0;break}p--,n+=e[c],r&&(o+=e[c])}else e[c].indexOf("else")>=0&&0===s?r=!0:(r||(n+=e[c]),r&&(o+=e[c]));q&&(m&&(b=m),d.push({type:"helper",helperName:h,contextName:i,content:n,inverseContent:o,hash:j}))}else f.indexOf(" ")>0&&d.push({type:"helper",helperName:h,contextName:i,hash:j})}}return d}var d=function(a,b){function d(a,b){return a.content?g(a.content,b):function(){return""}}function e(a,b){return a.inverseContent?g(a.inverseContent,b):function(){return""}}function f(a,b){var c;if(a.indexOf(".")>0)c=0===a.indexOf("this")?a.replace("this",b):b+"."+a;else if(0===a.indexOf("../")){var d=a.split("../").length-1,e=a.split("../")[a.split("../").length-1],f=b.split("_")[1]-d;c="ctx_"+(f>=1?f:1)+"."+e}else c="this"===a?b:b+"."+a;return a&&a.indexOf("@")>=0&&(c="(data && data."+a.replace("@","")+")"),c}function g(a,b){if(b=b||1,a=a||h.template,"string"!=typeof a)throw new Error("Template7: Template must be a string");var g=c(a);if(0===g.length)return function(){return""};var i="ctx_"+b,j="(function ("+i+", data) {\n";1===b&&(j+="function isArray(arr){return Object.prototype.toString.apply(arr) === '[object Array]';}\n",j+="function isFunction(func){return (typeof func === 'function');}\n",j+='function c(val, ctx) {if (typeof val !== "undefined") {if (isFunction(val)) {return val.call(ctx);} else return val;} else return "";}\n'),j+="var r = '';\n";var k;for(k=0;k<g.length;k++){var l=g[k];if("plain"!==l.type){var m;if("variable"===l.type&&(m=f(l.contextName,i),j+="r += c("+m+", "+i+");"),"helper"===l.type)if(l.helperName in h.helpers)m=f(l.contextName,i),j+="r += (Template7.helpers."+l.helperName+").call("+i+", "+m+", {hash:"+JSON.stringify(l.hash)+", data: data || {}, fn: "+d(l,b+1)+", inverse: "+e(l,b+1)+"});";else{if(l.contextName)throw new Error('Template7: Missing helper: "'+l.helperName+'"');m=f(l.helperName,i),j+="if ("+m+") {",j+="if (isArray("+m+")) {",j+="r += (Template7.helpers.each).call("+i+", "+m+", {hash:"+JSON.stringify(l.hash)+", data: data || {}, fn: "+d(l,b+1)+", inverse: "+e(l,b+1)+"});",j+="}else {",j+="r += (Template7.helpers.with).call("+i+", "+m+", {hash:"+JSON.stringify(l.hash)+", data: data || {}, fn: "+d(l,b+1)+", inverse: "+e(l,b+1)+"});",j+="}}"}}else j+="r +='"+l.content.replace(/\n/g,"\\n").replace(/'/g,"\\'")+"';"}return j+="\nreturn r;})",eval.call(window,j)}var h=this;h.template=a,h.context=b,h.compile=function(a){return h.compiled||(h.compiled=g(a)),h.compiled}};d.prototype={options:{},helpers:{"if":function(a,c){return b(a)&&(a=a.call(this)),a?c.fn(this,c.data):c.inverse(this,c.data)},unless:function(a,c){return b(a)&&(a=a.call(this)),a?c.inverse(this,c.data):c.fn(this,c.data)},each:function(c,d){var e="",f=0;if(b(c)&&(c=c.call(this)),a(c))for(d.hash.reverse&&!c.t7Reversed&&(c=c.reverse(),c.t7Reversed=!0),!d.hash.reverse&&c.t7Reversed&&(c=c.reverse(),c.t7Reversed=!1),f=0;f<c.length;f++)e+=d.fn(c[f],{first:0===f,last:f===c.length-1,index:f});else for(var g in c)f++,e+=d.fn(c[g],{key:g});return f>0?e:d.inverse(this)},"with":function(a,c){return b(a)&&(a=a.call(this)),c.fn(a)},join:function(a,c){return b(a)&&(a=a.call(this)),a.join(c.hash.delimeter)}}};var e=function(a,b){if(2===arguments.length){var c=new d(a),e=c.compile()(b);return c=null,e}return new d(a)};return e.registerHelper=function(a,b){d.prototype.helpers[a]=b},e.compile=function(a){var b=new d(a);return b.compile()},e.options=d.prototype.options,e.helpers=d.prototype.helpers,e}();