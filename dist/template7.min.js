/*
 * Template7 0.9.6
 * Mobile-first JavaScript template engine
 *
 * http://www.idangero.us/framework7/docs/template7.html
 *
 * Copyright 2014, Vladimir Kharlampidi
 * The iDangero.us
 * http://www.idangero.us/
 *
 * Licensed under MIT
 *
 * Released on: August 23, 2014
*/
window.Template7=function(){"use strict";function a(a){return"[object Array]"===Object.prototype.toString.apply(a)}function b(a){return a instanceof Object}function c(a){return"function"==typeof a}function d(a){var b,c,d=[];if(!a)return[];var e=a.split(/({{[^{^}]*}})/);for(b=0;b<e.length;b++){var f=e[b];if(""!==f)if(f.indexOf("{{")<0)d.push({type:"plain",content:f});else{if(f.indexOf("{/")>=0)continue;if(f.indexOf("{#")<0&&f.indexOf(" ")<0&&f.indexOf("else")<0){d.push({type:"variable",contextName:f.replace(/[{}]/g,"")});continue}var g=f.replace(/[{}#}]/g,"").split(" "),h=g[0],i=g[1],j={};if(g.length>2)for(var k,l=new RegExp(/\b(\w+)=["']([^"']+)(?=["'])/g);null!==(k=l.exec(f));)j[k[1]]="false"===k[2]?!1:k[2];if(f.indexOf("{#")>=0){var m,n="",o="",p=0,q=!1,r=!1,s=0;for(c=b+1;c<e.length;c++)if(e[c].indexOf("{{#")>=0&&s++,e[c].indexOf("{{/")>=0&&s--,e[c].indexOf("{{#"+h)>=0)n+=e[c],r&&(o+=e[c]),p++;else if(e[c].indexOf("{{/"+h)>=0){if(!(p>0)){m=c,q=!0;break}p--,n+=e[c],r&&(o+=e[c])}else e[c].indexOf("else")>=0&&0===s?r=!0:(r||(n+=e[c]),r&&(o+=e[c]));q&&(m&&(b=m),d.push({type:"helper",helperName:h,contextName:i,content:n,inverseContent:o,hash:j}))}else f.indexOf(" ")>0&&d.push({type:"helper",helperName:h,contextName:i,hash:j})}}return d}var e={},f=function(c,f){function g(a,c,d){if("this"===a||"undefined"==typeof a)return c;if(a.indexOf("@")>=0){var e=a.replace(/[@ ]/g,"");if(d&&"undefined"!=typeof d[e])return d[e]}if(a.indexOf(".")>0&&a.indexOf("../")<0){for(var f=a.split("."),g=c,h=0;h<f.length;h++)g="this"===f[h]?c:"undefined"!=typeof g&&b(c)&&f[h]in g?g[f[h]]:void 0;c=g}else a.indexOf("../")>=0||(c=c[a]?c[a]:void 0);return c}function h(a,b){return{fn:function(b,c){return i(a.content,b,c)},inverse:function(b,c){return a.inverseContent?i(a.inverseContent,b,c):""},content:a.content,inverseContent:a.inverseContent,hash:a.hash||{},helpers:j.helpers,data:b}}function i(c,e,f){c=c||j.template;var k,l,m=e||j.context,n=d(c),o="";for(k=0;k<n.length;k++){var p=n[k];if("plain"!==p.type){if("variable"===p.type&&(l=g(p.contextName,m,f),"undefined"!=typeof l&&(o+=l.toString())),"helper"===p.type){l=g(p.contextName,m,f);var q,r=h(p,f),s=p.helperName;if(p.helperName in j.helpers)q=j.helpers[s].call(m,l,r);else{if(p.contextName||!("this"===s||b(l)&&s in l))throw new Error('Missing helper: "'+s+'"');var t="this"===s?l:l[s];q=a(t)?j.helpers.each.call(m,l[s],r):i(p.content,l[s])}"undefined"!=typeof q&&(o+=q.toString())}}else o+=p.content}return o}var j=this;j.template=c,j.context=f,j.render=function(a){j.context=a,j.prevContext=void 0;var b,c,d;if(j.options.cache){for(var f in e)f.indexOf("template_")>=0&&e[f]===j.template&&(d=f.split("template_")[1],e["data_"+d]===a&&(c=e["rendered_"+d]));if(c)return c}return b=i(j.template,a),j.options.cache&&(d=(new Date).getTime(),e["template_"+d]=j.template,e["data_"+d]=a,e["rendered_"+d]=b),b}};f.prototype={options:{cache:!0},helpers:{"if":function(a,b){return c(a)&&(a=a.call(this)),a?b.fn(this,b.data):b.inverse(this,b.data)},unless:function(a,b){return c(a)&&(a=a.call(this)),a?b.inverse(this,b.data):b.fn(this,b.data)},each:function(b,d){var e="",f=0;if(c(b)&&(b=b.call(this)),a(b))for(d.hash.reverse&&!b.t7Reversed&&(b=b.reverse(),b.t7Reversed=!0),!d.hash.reverse&&b.t7Reversed&&(b=b.reverse(),b.t7Reversed=!1),f=0;f<b.length;f++)e+=d.fn(b[f],{first:0===f,last:f===b.length-1,index:f});else for(var g in b)f++,e+=d.fn(b[g],{key:g});return f>0?e:d.inverse(this)},"with":function(a,b){return c(a)&&(a=a.call(this)),b.fn(a)},join:function(a,b){return c(a)&&(a=a.call(this)),a.join(b.hash.delimeter)}}};var g=function(a,b){if(2===arguments.length){var c=new f(a),d=c.render(b);return c=null,d}return new f(a,b)};return g.registerHelper=function(a,b){f.prototype.helpers[a]=b},g.cache=e,g.clearCache=function(a){if(0===arguments.length)return void(e={});var b,c;for(b in e){var d="string"==typeof a?"template_":"data_";b.indexOf(d)>=0&&e[b]===a&&(c=b.split("_")[1])}c&&(delete e["template_"+c],delete e["data_"+c],delete e["rendered_"+c])},g.options=f.prototype.options,g.helpers=f.prototype.helpers,g}();